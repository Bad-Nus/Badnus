---
Tags:
  - é¢˜è§£
---
# é¢˜é¢
[P10678](../../é¢˜é¢/æ´›è°·é¢˜é¢/P10678.md)

![[../../é¢˜é¢/æ´›è°·é¢˜é¢/P10678|P10678]]
# åˆ†æ
> è®¾æ ‘é›† $T$,æ„é€ æ ‘é›† $T'$,æ ‘èŠ‚ç‚¹æ ‘ $n$,æ ¹èŠ‚ç‚¹ $R$,ä¸”æ ‘é›† $T'$ çš„æ¯ä¸ªå¶å­ç»“ç‚¹çš„æ·±åº¦ $l_j$,æœ€æ·±èŠ‚ç‚¹æ·±åº¦ $l_{max}$,éä¸¥æ ¼æ¬¡æ·±èŠ‚ç‚¹æ·±åº¦ $l_{max}'$,æ ‘çš„ç›´å¾„å­é›† $T_h$,æ ‘çš„ç›´å¾„é•¿ $h$.
> 
> æ±‚æ ‘çš„æœ€å°çš„**ä¸¤èŠ‚ç‚¹ä¹‹é—´æœ€å¤§è·ç¦»** $\text{diam}({T'})$ ç­‰ä»·äºæœ€å°çš„æ„é€ æ ‘ $T'$ çš„ç›´å¾„é•¿å³
> $$\text{diam}(T')=h_{min}=l_{max}+l'_{max}$$
> 
> æœ‰ $h_{min}\le 2l_{max}$, $R\in T_h\in T'$

> ç»™å®šæ ‘ $T$ æ¯ä¸ªèŠ‚ç‚¹åº¦æ•° $d_i$,æ±‚æ ‘æœ€å°ç›´å¾„æ·±åº¦ $h_{min}$,æ˜¾ç„¶æ¯ä¸ªèŠ‚ç‚¹çš„ç¼–å·ä¸å½±å“æ ‘çš„æ„é€ ,æˆ‘ä»¬åªè¦å…³å¿ƒé€šè¿‡èŠ‚ç‚¹åº¦æ•°æ„é€ ,ç”± $h_{min}\le 2l_{max}$ å¾—éœ€æœ€å°åŒ–æ„é€ æ ‘çš„æœ€å¤§æ·±åº¦.
> 
> ç”±äºèŠ‚ç‚¹æ€»åº¦æ•°ç¡®è®¤,æ ‘è¾¹è¦ä¹ˆä½¿æ ‘"å˜æ·±",è¦ä¹ˆä½¿æ ‘"å˜å®½",é‚£ä¹ˆä¸€æ—¦å»ºè¾¹ä¼˜å…ˆä½¿å…¶"å˜å®½"å¿…ç„¶æœ€å°åŒ– $l_{max}$,å¯ä»¥ç†è§£æˆå°†æ‰€æœ‰çš„ç‚¹åŠå…¶å­æ ‘å°½å¯èƒ½å‘ä¸Šç§»,ä¹Ÿå°±æ˜¯è®©å…¥åº¦å¤§çš„ç‚¹å°½å¯èƒ½ä¸Šç§».
> 
> é‚£ä¹ˆå°†ç‚¹å…¥åº¦ä»å¤§åˆ°å°æ’åº,é‚£ä¹ˆæ ¹èŠ‚ç‚¹å–å…¥åº¦æœ€å¤§ç‚¹,æ¯æ¬¡å»ºè¾¹éƒ½å–å‰©ä½™çš„å…¥åº¦æœ€å¤§çš„ç‚¹.
# å…·ä½“å®ç°
> ç”¨ç»“æ„ä½“ $\text{vector}$ æ¨¡æ‹Ÿæ ‘,å°†æ¯ä¸ªå…ƒç´ çš„åº¦æ•°å’ŒåŸæ¬¡åºç»‘å®š,è´ªå¿ƒå–å…¥åº¦æœ€å¤§ç‚¹å»ºæ ‘
> 
> ï¼ˆæ”¹åº¦æ•°ç”¨å‡ºåº¦,é™¤äº†æ ¹èŠ‚ç‚¹ä¹‹å¤–çš„åº¦æ•°å‡å‡ä¸€ä¸ºå‡ºåº¦ï¼‰
> 
> æ€•ä»£ç ä¸æ–¹ä¾¿ç†è§£,è¡¥ä¸ªç›¸å½“é€šä¿—çš„æ ·ä¾‹è°ƒè¯•(å¦‚æ ·ä¾‹ $4$ ):
> ![](https://cdn.luogu.com.cn/upload/image_hosting/jb5lg28w.png)
```
7
1 3 2 3 1 1 1
```
> é€šè¿‡ç»“æ„ä½“å°†æ¯ä¸ªå…ƒç´ çš„åº¦æ•°å’ŒåŸæ¬¡åºç»‘å®š,å¾—å¦‚ä¸‹é¡ºåºï¼š

```
//è¡¨æ ¼1
2 4 3 1 5 6 7
3 3 2 1 1 1 1
```
> å»ºæ ‘ï¼š
```
//è¡¨æ ¼2
2      //èŠ‚ç‚¹æƒ…å†µ
4 3 1 
5 6 7 

3      //å­èŠ‚ç‚¹æ•°
2 1 0
0 0 0
```

# é™„ä»£ç ï¼š

```cpp
#include <bits/stdc++.h>
using namespace std;
#define to(x,y); for(int x=1;x<=y;x++)
#define fr(x,y); for(int x=0;x<y;x++)
const int N = 2e5 + 20;
int t, n, sum[N];

struct nd {
	int ord, cry;
} p[N];
vector<nd> tr[N];

bool cmp(nd a, nd b) {
	if (a.cry == b.cry)
		return a.ord < b.ord;
	return a.cry > b.cry;
}

int main() {
	scanf("%d", &t);
	while (t--) {
		scanf("%d", &n);
		to(i, n)scanf("%d", &p[i].cry), p[i].ord = i;
		sort(p + 1, p + 1 + n, cmp);
		to(i, n) {
			if (i > 1)
				p[i].cry--;
			sum[i] = sum[i - 1] + p[i].cry;
		}
		int l = 1, r = 1, num, dep = 1;
		tr[1].push_back({p[1].ord, p[1].cry});
		while (r < n) {
			dep++;
			num = sum[r] - sum[l - 1];
			l = r + 1, r = r + num;
			for (int i = l; i <= r; i++)
				tr[dep].push_back({p[i].ord, p[i].cry});
		}
		to(i, dep - 1) {
			int len = tr[i].size(), idx = 0;
			fr(j, len) {
				for (int k = 0; k < tr[i][j].cry; k++) {
					printf("%d %d\n", tr[i][j].ord, tr[i + 1][idx + k].ord);
				}
				idx += tr[i][j].cry;
			}
		}
		to(i, dep)vector <nd>().swap(tr[i]);
	}

	return 0;
}
```



------------

## å†é™„å¸¦æœ‰ä¸Šé¢è¡¨æ ¼å¯è§†åŒ–è¾“å‡ºå¹¶é™„è§£é‡Šçš„å®Œæ•´ç‰ˆï¼š
```cpp
#include <bits/stdc++.h>
using namespace std;
#define to(x,y); for(int x=1;x<=y;x++) //ä¸‘é™‹çš„ä»£ç åŒ–ç®€ä¹ æƒ¯
#define fr(x,y); for(int x=0;x<y;x++)
const int N = 2e5 + 20;
int t, n, sum[N];

// sum ä¸ºå‡ºåº¦å‰ç¼€å’Œ,æ±‚æ¯å±‚çš„èŠ‚ç‚¹æ•°
struct nd {
	int ord, cry;//ordåºå·,cryåº¦æ•°
} p[N];          //å­˜è¾“å…¥æ•°æ®å¹¶åšé¢„å¤„ç†ç”¨
vector<nd> tr[N];//æ ¸å¿ƒ vector æ ‘

bool cmp(nd a, nd b) {
	if (a.cry == b.cry)
		return a.ord < b.ord;
	return a.cry > b.cry;
}//æ’åºé¢„å¤„ç†

int main() {
	scanf("%d", &t);
	while (t--) {
		scanf("%d", &n);
		to(i, n)scanf("%d", &p[i].cry), p[i].ord = i;
		sort(p + 1, p + 1 + n, cmp)ï¼›
		
		
		
		/*è¡¨æ ¼ä¸€*/
//		puts("\n&&&");
//		to(i, n)printf("%d ", p[i].ord);
//		puts("");
//		to(i, n)printf("%d ", p[i].cry);
//		puts("\n&&&\n");
		
		
		
		to(i, n) {
			if (i > 1)
				p[i].cry--;//æ”¹åº¦æ•°ä¸ºå‡ºåº¦
			sum[i] = sum[i - 1] + p[i].cry;//ç®—æ¯å±‚èŠ‚ç‚¹æ•°
		}
		int l = 1, r = 1, num, dep = 1;
		tr[1].push_back({p[1].ord, p[1].cry});//å­˜ä¸‹æ ¹èŠ‚ç‚¹
		while (r < n) {
			dep++;//ç”±ä¸Šä¸€å±‚æ¥åˆ°ä¸‹ä¸€å±‚
			num = sum[r] - sum[l - 1];//ä¸Šå±‚åº¦æ•°ä¹‹å’Œ
			l = r + 1, r = r + num;
			for (int i = l; i <= r; i++)//â€œé¢†å…»â€å­èŠ‚ç‚¹
				tr[dep].push_back({p[i].ord, p[i].cry});//å­˜ä¸‹è¯¥å±‚å­èŠ‚ç‚¹
		}
		
		
		
		/*è¡¨æ ¼äºŒ*/
//		to(i, dep) {
//			printf("&&&");
//			int len = tr[i].size();
//			fr(j, len)printf("%d ", tr[i][j].ord);
//			puts("&&&");
//		}
//		puts("");
//		to(i, dep) {
//			printf("&&&");
//			int len = tr[i].size();
//			fr(j, len)printf("%d ", tr[i][j].cry);
//			puts("&&&");
//		}
		
		
		
		to(i, dep - 1) {
			int len = tr[i].size(), idx = 0;
			// idx ä¸ºå¾…é¢†å…»å­èŠ‚ç‚¹
			fr(j, len) {
				for (int k = 0; k < tr[i][j].cry; k++) {
					printf("%d %d\n", tr[i][j].ord, tr[i + 1][idx + k].ord);
				}//è¾“å‡ºçˆ¶å­
				idx += tr[i][j].cry;//é¢†ä¸‹ä¸€æ‰¹å­èŠ‚ç‚¹
			}
		}
		to(i, dep)vector <nd>().swap(tr[i]);
		//æ¸…ç©º vector æ ‘
	}
	return 0;//å®Œç»“æ’’èŠ±ğŸŒ¸
}

```
