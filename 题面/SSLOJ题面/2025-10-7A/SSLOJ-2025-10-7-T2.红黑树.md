---
Tags:
  - 题面
---
# SSLOJ-2025-10-7-T 2. 红黑树
题解：[题解：SSLOJ-2025-10-7-T2.红黑树](../../../题解/SSLOJ/2025-10-7A/题解：SSLOJ-2025-10-7-T2.红黑树.md)

题解：[[../../../题解/SSLOJ/2025-10-7A/题解：SSLOJ-2025-10-7-T2.红黑树|题解：SSLOJ-2025-10-7-T2.红黑树]]
## 题目描述

在本题中，我们定义红黑树为既包含黑点又包含红点的树。

给定一棵 $n$ 个点的有根树，根为节点 $1$ ，初始每个点都是红色，有 $n$ 次操作，每次操作会把 $p_i$ 变成黑色，保证操作序列 $p$ 是一个排列，即每次操作的点都不相同。

每次操作完成后，你需要输出有多少个子树是红黑子树，即子树内既包含黑点又包含红点。

## 输入格式

第一行一个整数 $n$

第二行 $n - 1$ 个整数，第 $i$ 个整数表示第 $i + 1$ 个点的父亲节点 $fa_i$

第三行 $n$ 个整数 $p_i$ ，表示操作序列

## 输出格式

一行 $n$ 个整数，表示每次操作后有多少个子树是红黑子树

## 数据范围与提示

对于 $20\%$ 的数据， $fa_i = i - 1$

对于 $50\%$ 的数据， $n \leq 5000$

对于 $100\%$ 的数据， $1 \leq n \leq 10^5$ , $fa_i < i$