---
Tags:
  - 学习笔记
---
## 简单题
给定 $n$ 个 $a_i,l_i,r_i$
定义 

$$f_{i}=
\begin{cases}
0,v_i\notin [l_i,r_i]\\
\frac{v_i-l_i+1}{r_i-l_i+1}a_i,v_i\in [l_i,r_i]
\end{cases}
$$

求 $\sum\limits v_i$ 为定值 $m$ 时的最大 $\sum\limits_{i=1}^n f(i)$

其中 $n,m\le 1e4$ ， $l_i\le r_i\le 1e9$ ， $a_i\le 1e9$

给出 c++代码
$f_i(v_i) = a_i * (v_i - l_i + 1) / d_i = (a_i/d_i) * v_i + a_i * (1 - l_i) / d_i$
## 韦达定理高次推广
对一元 $n$ 次方程的解集，有

$$
\begin{split}
f(x)
&=\sum\limits_{i=1}^n(a_i\times x^i)\\
\text{①}&=a_n\times x^n+a_{n-1}\times x^{n-1}+...+a_1x+a_0\\
\text{②}&=a\times\prod\limits_{i=1}^n(x-x_i)\\
\text{③}&=a\times x^n-a\times(\sum\limits_{i=1}^n x_i)x^{n-1}+a\times(\sum\limits_{1\le i\le j\le n}x_i x_j)x^{n-2}+...+a\times(\prod\limits_{i=1}^n x_i)
\end{split}
$$

通过比较 $\text{①}$ 和 $\text{③}$ 我们可以得到：

我们定义 $g(e)$ 为方程任意 $e$ 个元素乘积和，得到高次方程韦达定理推论

$$
\begin{cases}
g(1)=(\sum\limits x_i&)=(-1)^1\frac{\\a_{n-1}}{a_n}\\
g(2)=(\sum\limits x_ix_j&)=(-1)^2\frac{a_{n-2}}{a_n} \\
g(3)=(\sum\limits x_ix_jx_k&)=(-1)^3\frac{a_{n-3}}{a_n}\\
...\\
\Downarrow\\
g(i)=(\sum\limits x_ix_jx_k...&)=(-1)^i\frac{a_{n-i}}{a_n}
\end{cases}
$$

## 数学符号

## 特征方程题
若 $f$ 满足 $f(0)=1, f(1)=0, f(2)=2$ 给定递推关系:

$$
f(n)=2f(n-1)+f(n-2)-2f(n-3)
$$

设解的形式为 $f(x)=r^n$ 则:

$$
\boxed{\begin{split}
r^n&=2r^{n-1}+r^{n-2}-2r^{n-3}\\
r^3&=2r^2+r-2\\
0&=r^3-2r^2-r+2
\end{split}}
$$
试根， $r=1$ 成立，则：

$$r^3-2r^2-r+2=(r-1)(r^2-r-2)$$

显然试根 $r=-1$ 也成立，那么：

$$
r^3-2r^2-r+2=(r-1)(r^2-r-2)=(r-1)(r+1)(r-2)
$$

带入特征根，得：

$$F (n)=A\times (1)^n+B\times (2)^n+C\times (-1)^n=A+B\times 2^n+C\times (-1)^n$$

代入已知，那么：


$$
\begin{split}
&n=0:f(0)=A+B+C=1\\
&n=1:f(1)=A+2B-C=0\\
&n=2:f(2)=A+4B+C=2
\end{split}
$$

解得：

$$
A=0,B=\frac{1}{3},C=\frac{2}{3}
$$

得：

$$
\begin{split}
f(n)&=\frac{1}{3}\times 2^n +\frac{2}{3}\times (-1)^n\\
&=\frac{(2^n)}{3}+ \frac{2(-1)^n}{3}
\end{split}
$$

## 特征方程

特征方程的根决定了递推关系通解的形式：

**(1) 所有根均为单根（无重根）**

设特征根为 $r_1, r_2, \ldots, r_k$ ，则通解为：

$$ f(n) = c_1 r_1^n + c_2 r_2^n + \cdots + c_k r_k^n $$

**(2) 存在重根**

若 $r$ 是重根（重数为 $m$），则对应的通解部分为：

$$ (c_1 + c_2 n + \cdots + c_m n^{m-1}) r^n $$

**(3) 存在复根**

若特征根为复数 $r = a \pm bi$ ，则对应的通解部分为：

$$ \rho^n (c_1 \cos n \theta + c_2 \sin n \theta) $$

其中 $\rho = \sqrt{a^2 + b^2}$ （模长）， $\theta = \arctan(b/a)$ （辐角）。

## 斐波那契特征方程解

斐波那契数列可看作求递推关系：

$$\begin{cases}
f_1 = 1 \\
f_2 = 1 \\
f_n = f_{n-1} + f_{n-2}, (n \geq 3)
\end{cases}$$

其递推关系的特征方程为 $x^2 = x + 1$

其两根为 $x_1 = \frac{1 + \sqrt{5}}{2},x_2 = \frac{1 - \sqrt{5}}{2}$

由特征根定理可得该递推关系通解为：

$$f_n = A \cdot \left( \frac{1 + \sqrt{5}}{2} \right)^n + B \cdot \left( \frac{1 - \sqrt{5}}{2} \right)^n$$

代入初始条件 $f_1 = 1$ , $f_2 = 1$ 即可得关于待定系数 $A$ , $B$ 的方程组：

$$\begin{cases}
\frac{1 + \sqrt{5}}{2} A + \frac{1 - \sqrt{5}}{2} B = 1 \\
\frac{3 + \sqrt{5}}{2} A + \frac{3 - \sqrt{5}}{2} B = 1
\end{cases}$$

解得待定系数 $A$ , $B$ ：

$$\begin{cases}
A = \frac{\sqrt{5}}{5} \\
B = -\frac{\sqrt{5}}{5}
\end{cases}$$

于是得本递推关系特解： 

$$f_n = \frac{\sqrt{5}}{5} \left[ \left( \frac{1 + \sqrt{5}}{2} \right)^n - \left( \frac{1 - \sqrt{5}}{2} \right)^n \right]$$
## 树状数组区改

区间修改不难想到查分维护，解决了修改，但代价维护查分后每次查询做查分合并复杂度 $O(n)$ ，不可接受。

考虑优化查分合并，设原数组 $a$ ，查分 $d$ ，有

$$
\begin{split}
\sum\limits_{i=1}^{r}a_i&=\sum\limits_{i=1}^{r}\sum\limits_{j=1}^{i}d_j\\
&=\sum\limits_{i=1}^{r}(r-i+1)d_i\\
&=(r+1)\times\sum\limits_{i=1}^{r}d_i-\sum\limits_{i=1}^{r}{(d_i\times i)}
\end{split}
$$

那么分别维护 $\sum d_i$ 和 $\sum (d_i\times i)$ 两个树状数组即可恢复查询 $O(\log n)$ 复杂度

我们再考虑怎么维护修改：

1. $d_i$ 的修改 
对 $d_i$ 的修改是平凡的，对 $l$ 处进行 $+v$ 的单点修改，对 ${r+1}$ 处进行 $-v$ 的单点修改即可

2. $d_i\times i$ 的修改
讨论 $d_i\times i$ 的变化，他的 $d_i$ 随上面的平凡修改而变化

那么 $d_i\times i$ 跟随变化即可，为 $l$ 处的 $(+v)\times l$ 及 $r+1$ 处的 $(-v)\times(r+1)$ 。

那么对 $l$ 处进行 $(+v)\times l$ 的单点修改，对 ${r+1}$ 处进行 $(-v)\times(r+1)$ 的单点修改即可

# 代码内存查询

```cpp
//文件头
bool mBe;
//你所有的函数，变量等
bool mEd;
int main(){
  cout << fabs(&mBe - &mEd) / 1024.0 / 1024.0 << "MB\n";
  //主函数
}
```

